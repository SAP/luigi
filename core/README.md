# Luigi Core

## Overview

Luigi core is a micro front-end framework written in Svelte. To learn how it works, read [this](examples/README.md) document.

## Usage

Read the subsections to learn how to use the project.

### Build and deploy locally

Build and deploy the project using one of the following approaches:

**Simple one-time approach**

Go to the `core` folder and run the following command:

`npm run-script bundle && cp -R ./public/ examples/luigi-sample-angular/node_modules/@kyma-project/luigi-core/`

**Build and deploy in development mode**

For non-minified sources, use this approach.
Go to the `core` folder and run the following command:

`npm run-script bundle-develop && cp -r ./public/ examples/luigi-sample-angular/node_modules/@kyma-project/luigi-core/`

**Link and build with Lerna**

Linking and building with Lerna is the preferred development method.
This mono repository uses [Lerna](https://lernajs.io/) for project management. Check that Lerna is installed. If it is not, run `npm install --global lerna`

Follow these steps:

1. Install dependencies. 
The `lerna bootstrap` command executes npm install and links cross-dependencies.
```bash
lerna bootstrap
```

2. Bundle cross-dependencies.  
The `lerna run` command runs the given script in every package referenced in the `lerna.json` file.
```bash
lerna run bundle
// or non-minified and watcher:
lerna run bundle-develop
```

3. Serve public directory
Distribution files generated by `lerna run bundle` and `lerna run bundle` are stored in `core/public` folder. 
Point your local webserver to this directory or use a eg. node based webserver:
```bash
npm install --global local-web-server
0
````

### Run tests

To perform the unit test on JavaScript files, run `npm test`.

To test svelte components using cypress-svelte-unit-test, run `npm run cypress-test`. It runs all tests headlessly in the Electron browser.

To test svelte components in an interactive mode using cypress-svelte-unit-test, run `npm run cypress-open`.
