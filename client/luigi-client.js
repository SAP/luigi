!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.LuigiClient=e():t.LuigiClient=e()}(window,function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}n.r(e);var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.promises={}}var e,n,r;return e=t,(n=[{key:"setPromise",value:function(t,e){this.promises[t]=e}},{key:"getPromise",value:function(t){return this.promises[t]}}])&&o(e.prototype,n),r&&o(e,r),t}();function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var a=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners=[],window.addEventListener("message",function(t){this.listeners.filter(function(e){return e.name===t.data.msg}).map(function(e){return e.eventFn(t,e.listenerId)})}.bind(this))}var e,n,o;return e=t,(n=[{key:"addEventListener",value:function(t,e){this.listeners.push({name:t,eventFn:e,listenerId:this.getRandomId()})}},{key:"removeEventListener",value:function(t){this.listeners=this.listeners.filter(function(e){return e.listenerId!==t})}},{key:"getRandomId",value:function(){return(window.crypto||window.msCrypto).getRandomValues(new Uint32Array(1))[0]}},{key:"isFunction",value:function(t){return"function"==typeof t}}])&&i(e.prototype,n),o&&i(e,o),t}());function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function c(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=new(function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=c(this,l(e).call(this))).luigiInitialized=!1,t.defaultContextKeys=["context","internal","nodeParams","pathParams"],t.setCurrentContext(t.defaultContextKeys.reduce(function(t,e){return t[e]={},t},{})),t._onContextUpdatedFns={},t._onInitFns={},t.authData={};var n,o,r=function(t,e){for(var n in t)t.hasOwnProperty(n)&&a.isFunction(t[n])&&t[n](e)};return n=function(e){for(var n=0;n<t.defaultContextKeys.length;n++){var o=t.defaultContextKeys[n];try{"string"==typeof e[o]&&(e[o]=JSON.parse(e[o]))}catch(t){console.info("unable to parse luigi context data for",o,e[o],t)}}t.setCurrentContext(e)},o=function(e){e&&(t.authData=e)},a.addEventListener("luigi.init",function(e){n(e.data),o(e.data.authData),t.luigiInitialized=!0,r(t._onInitFns,t.currentContext.context)}),a.addEventListener("luigi.auth.tokenIssued",function(t){o(t.data.authData)}),a.addEventListener("luigi.navigate",function(e){n(e.data),t.currentContext.internal.isNavigateBack||window.location.replace(e.data.viewUrl),r(t._onContextUpdatedFns,t.currentContext.context),window.parent.postMessage({msg:"luigi.navigate.ok"},"*")}),window.parent.postMessage({msg:"luigi.get-context"},"*"),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(e,r),n=e,(o=[{key:"setCurrentContext",value:function(t){this.currentContext=t}},{key:"addInitListener",value:function(t){var e=a.getRandomId();return this._onInitFns[e]=t,this.luigiInitialized&&a.isFunction(t)&&t(this.currentContext.context),e}},{key:"removeInitListener",value:function(t){return!!this._onInitFns[t]&&(this._onInitFns[t]=void 0,!0)}},{key:"addContextUpdateListener",value:function(t){var e=a.getRandomId();return this._onContextUpdatedFns[e]=t,this.luigiInitialized&&a.isFunction(t)&&t(this.currentContext.context),e}},{key:"removeContextUpdateListener",value:function(t){return!!this._onContextUpdatedFns[t]&&(this._onContextUpdatedFns[t]=void 0,!0)}},{key:"getToken",value:function(){return this.authData.accessToken}},{key:"getEventData",value:function(){return this.currentContext.context}},{key:"getNodeParams",value:function(){return this.currentContext.nodeParams}},{key:"getPathParams",value:function(){return this.currentContext.pathParams}}])&&u(n.prototype,o),i&&u(n,i),e}());function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var m=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,n=!(r=y(e).call(this))||"object"!==p(r)&&"function"!=typeof r?h(o):r,Object.assign(h(n),t),n.options={preserveView:!1,nodeParams:{},errorSkipNavigation:!1,fromContext:null,fromClosestContext:!1,relative:!1,link:""},n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(e,r),n=e,(o=[{key:"navigate",value:function(t,e,n,o,r){if(this.options.errorSkipNavigation)this.options.errorSkipNavigation=!1;else{this.options.preserveView=n;var i="/"!==t[0],a={msg:"luigi.navigation.open",sessionId:e,params:Object.assign(this.options,{link:t,relative:i,modal:o||r})};window.parent.postMessage(a,"*")}}},{key:"openAsModal",value:function(t,e){this.navigate(t,0,!0,e||{})}},{key:"openAsSplitView",value:function(t,e){this.navigate(t,0,!0,void 0,e||{})}},{key:"fromContext",value:function(t){return-1!==this.currentContext.context.parentNavigationContexts.indexOf(t)?this.options.fromContext=t:(this.options.errorSkipNavigation=!0,console.error("Navigation not possible, navigationContext "+t+" not found.")),this}},{key:"fromClosestContext",value:function(){return this.currentContext.context.parentNavigationContexts.length>0?(this.options.fromContext=null,this.options.fromClosestContext=!0):console.error("Navigation not possible, no parent navigationContext found."),this}},{key:"withParams",value:function(t){return t&&Object.assign(this.options.nodeParams,t),this}},{key:"pathExists",value:function(t){var e=Date.now(),n=this.getPromise("pathExistsPromises")||{};n[e]={resolveFn:function(){},then:function(t){this.resolveFn=t}},this.setPromise("pathExistsPromises",n),a.addEventListener("luigi.navigation.pathExists.answer",function(t,e){var n=t.data.data,o=this.getPromise("pathExistsPromises")||{};o[n.correlationId]&&(o[n.correlationId].resolveFn(n.pathExists),delete o[n.correlationId],this.setPromise("pathExistsPromises",o)),a.removeEventListener(e)}.bind(this));var o={msg:"luigi.navigation.pathExists",data:{id:e,link:t,relative:"/"!==t[0]}};return window.parent.postMessage(o,"*"),n[e]}},{key:"hasBack",value:function(){return!!this.currentContext.internal.modal||0!==this.currentContext.internal.viewStackSize}},{key:"goBack",value:function(t){this.hasBack()&&window.parent.postMessage({msg:"luigi.navigation.back",goBackContext:t&&JSON.stringify(t)},"*")}}])&&v(n.prototype,o),i&&v(n,i),e}();function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function x(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function C(t,e){return(C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var P=new(function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),x(this,k(e).call(this))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(e,r),n=e,(o=[{key:"showLoadingIndicator",value:function(){window.parent.postMessage({msg:"luigi.show-loading-indicator"},"*")}},{key:"hideLoadingIndicator",value:function(){window.parent.postMessage({msg:"luigi.hide-loading-indicator"},"*")}},{key:"addBackdrop",value:function(){window.parent.postMessage({msg:"luigi.add-backdrop"},"*")}},{key:"removeBackdrop",value:function(){window.parent.postMessage({msg:"luigi.remove-backdrop"},"*")}},{key:"setDirtyStatus",value:function(t){window.parent.postMessage({msg:"luigi.set-page-dirty",dirty:t},"*")}},{key:"showConfirmationModal",value:function(t){var e=this;a.addEventListener("luigi.ux.confirmationModal.hide",function(t,n){e.hideConfirmationModal(t.data.data),a.removeEventListener(n)}),window.parent.postMessage({msg:"luigi.ux.confirmationModal.show",data:{settings:t}},"*");var n={};return n.promise=new Promise(function(t,e){n.resolveFn=t,n.rejectFn=e}),this.setPromise("confirmationModal",n),n.promise}},{key:"hideConfirmationModal",value:function(t){var e=this.getPromise("confirmationModal");e&&(t.confirmed?e.resolveFn():e.rejectFn(),this.setPromise("confirmationModal",void 0))}},{key:"showAlert",value:function(t){var e=this;a.addEventListener("luigi.ux.alert.hide",function(t,n){e.hideAlert(t.data.id),a.removeEventListener(n)}),t.id=a.getRandomId(),t.closeAfter&&t.closeAfter<100&&(console.warn("Message with id='".concat(t.id,"' has too small 'closeAfter' value. It needs to be at least 100ms.")),t.closeAfter=void 0),window.parent.postMessage({msg:"luigi.ux.alert.show",data:{settings:t}},"*");var n=this.getPromise("alerts")||{};return n[t.id]={},n[t.id].promise=new Promise(function(e){n[t.id].resolveFn=e}),this.setPromise("alerts",n),n[t.id].promise}},{key:"hideAlert",value:function(t){var e=this.getPromise("alerts");t&&e[t]&&(e[t].resolveFn(t),delete e[t],this.setPromise("alerts",e))}}])&&w(n.prototype,o),i&&w(n,i),e}());function O(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var _=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,(n=[{key:"addInitListener",value:function(t){return d.addInitListener(t)}},{key:"removeInitListener",value:function(t){return d.removeInitListener(t)}},{key:"addContextUpdateListener",value:function(t){return d.addContextUpdateListener(t)}},{key:"removeContextUpdateListener",value:function(t){return d.removeContextUpdateListener(t)}},{key:"getToken",value:function(){return d.getToken()}},{key:"getEventData",value:function(){return d.getEventData()}},{key:"getNodeParams",value:function(){return d.getNodeParams()}},{key:"getPathParams",value:function(){return d.getPathParams()}},{key:"linkManager",value:function(){return new m({currentContext:d.currentContext})}},{key:"uxManager",value:function(){return P}},{key:"lifecycleManager",value:function(){return d}}])&&O(e.prototype,n),o&&O(e,o),t}();e.default=_=new _}]).default});