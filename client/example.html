<html>
    <head>
        <script src="luigi-client.js" ></script>
    </head>
    <body>

        <h2>URL</h2>
        <p><code id="url"></code></p>

        <h2>Context</h2>
        <p><code id="context"></code></p>

        <h2>Node Params</h2>
        <p><code id="nodeParams"></code></p>

        <h2>Navigation</h2>
        <p><label>path to go:   </label>  <input id="pathInput" type="text"> </p>
        <p>relative <input id="pathRelativeCB" type="checkbox"></p>
        <p>from a context <input id="pathMark" type="text"></p>
        <p>from the closest context <input id="pathClosestMarkCB" type="checkbox"></p>
        <p><button id="pathButton" onclick="go()">GO!</button></p>

        <script type="text/javascript">

            document.getElementById('url').innerText = window.location;

            window.Luigi.addContextUpdateListener(() => {
                console.log('yay, initialized');
                document.getElementById('context').innerText = JSON.stringify(Luigi.getEventData());
                document.getElementById('nodeParams').innerText = JSON.stringify(Luigi.getNodeParams());
            });

            go = function() {
                var to = document.getElementById('pathInput').value;
                console.log("TO: " + to);
                if (!to) {
                    return;
                }
                var relative = document.getElementById('pathRelativeCB').checked;
                console.log("RELATIVE: " + relative);
                var navigationMark = document.getElementById('pathMark').value;
                console.log("FROM CONTEXT: " + navigationMark);
                var closestNavigationMark = document.getElementById('pathClosestMarkCB').checked;
                console.log("FROM CLOSEST CONTEXT: " + closestNavigationMark);
                if (closestNavigationMark) {
                    Luigi.linkManager().fromClosestContext().navigate(to, Luigi.getEventData().sessionId);
                } else if (navigationMark) {
                    Luigi.linkManager().fromContext(navigationMark).navigate(to, Luigi.getEventData().sessionId);
                } else if (relative) {
                    Luigi.linkManager().navigateFromHere(to, Luigi.getEventData().sessionId);
                } else {
                    Luigi.linkManager().navigate(to, Luigi.getEventData().sessionId);
                }
            };

            document.getElementById('pathButton').onclick = go;

        </script>

    </body>
</html>